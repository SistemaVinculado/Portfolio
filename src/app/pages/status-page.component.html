<!-- The main relative container that defines the boundary for the sticky element -->
<div class="relative w-full max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 min-h-[calc(100vh-200px)]">
  
  <!-- Blurred Background Content Layer -->
  <div class="blur-md pointer-events-none select-none">
    <header class="py-12">
      <h1 class="text-5xl md:text-6xl font-extrabold tracking-tighter text-center text-[#292639] dark:text-white">{{ pageTitle() }}</h1>
      <p class="mt-4 text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto text-center">{{ pageSubtitle() }}</p>
    </header>
    
    <!-- Overall Status Banner -->
    <div appAnimateOnScroll [ngClass]="statusStyles()" class="p-8 mb-12 rounded-2xl flex flex-col md:flex-row items-center justify-center text-center gap-4">
        <svg [ngSwitch]="overallStatus().type" class="w-12 h-12 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          @switch (overallStatus().type) {
            @case ('operational') { <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /> }
            @case ('degraded') { <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /> }
            @case ('outage') { <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" /> }
          }
        </svg>
        <div>
          <h2 class="text-2xl font-bold">{{ overallStatus().message }}</h2>
          <div class="flex items-center justify-center gap-2 mt-1">
            <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
            <p class="text-sm">{{ t('pages.status.lastUpdated') }} {{ lastUpdated() | date:'mediumTime' }}</p>
          </div>
        </div>
    </div>
  
    <!-- Systems List -->
    <section class="mb-16">
      <h3 class="text-2xl font-bold mb-6 text-[#292639] dark:text-white">{{ t('pages.status.coreSystems') }}</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (system of systemStatuses(); track system.name; let i = $index) {
          <div appAnimateOnScroll [delay]="(i * 100) + 'ms'" class="bg-white dark:bg-gray-800/30 p-6 rounded-xl border border-gray-200 dark:border-gray-700/50">
            <div class="flex items-center justify-between">
              <h4 class="text-lg font-bold text-[#292639] dark:text-white">{{ system.name }}</h4>
              <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full" [ngClass]="getStatusIndicatorClass(system.status)"></div>
                <span class="text-sm font-semibold text-gray-700 dark:text-gray-300 capitalize">{{ system.status }}</span>
              </div>
            </div>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">{{ system.description }}</p>
          </div>
        }
      </div>
    </section>
  
    <!-- Incident History -->
    <section>
      <h3 class="text-2xl font-bold mb-8 text-[#292639] dark:text-white">{{ t('pages.status.integrityLog') }}</h3>
      <div class="space-y-8">
        @for (incident of incidents(); track incident.title; let i = $index) {
          <div appAnimateOnScroll [delay]="(i * 100) + 'ms'" class="bg-white dark:bg-gray-800/30 rounded-xl border border-gray-200 dark:border-gray-700/50 overflow-hidden">
            <button 
              (click)="toggleIncident(i)" 
              [attr.aria-expanded]="openIncidentIndex() === i"
              class="w-full flex flex-col md:flex-row items-start md:items-center justify-between text-left p-6 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200 gap-4">
                <div class="flex-grow">
                  <p class="text-sm text-gray-500 dark:text-gray-400">{{ incident.date }}</p>
                  <h4 class="text-lg font-semibold text-[#292639] dark:text-white mt-1">{{ incident.title }}</h4>
                </div>
                <div class="flex items-center gap-2 self-start md:self-center">
                  <span class="text-xs font-bold uppercase tracking-wider px-3 py-1 rounded-full" [ngClass]="{
                    'bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-300': incident.status === 'resolved',
                    'bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300': incident.status === 'monitoring',
                    'bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-300': incident.status === 'investigating'
                  }">{{ incident.status }}</span>
                  <svg [class.rotate-180]="openIncidentIndex() === i" class="w-5 h-5 text-gray-500 dark:text-gray-400 transform transition-transform duration-300 ease-in-out flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                  </svg>
                </div>
            </button>
  
            @if (openIncidentIndex() === i) {
              <div class="px-6 pb-6 pt-0 animate-slide-down">
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                  @for (update of incident.updates; track update) {
                    <div class="relative pl-8 py-2">
                      <div class="absolute top-2 left-0 h-full w-px bg-gray-200 dark:bg-gray-600"></div>
                      <div class="absolute top-2 left-[-4.5px] w-3 h-3 rounded-full" [ngClass]="getIncidentIndicatorClass(incident.status)"></div>
                      <p class="text-sm text-gray-600 dark:text-gray-400">{{ update }}</p>
                    </div>
                  }
                </div>
              </div>
            }
          </div>
        } @empty {
          <div class="text-center py-12 text-gray-500 dark:text-gray-400 bg-white/30 dark:bg-gray-800/20 rounded-2xl">
              <svg class="w-12 h-12 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="font-semibold text-xl">{{ t('pages.status.noIncidents') }}</p>
              <p class="mt-2">{{ t('pages.status.noIncidentsHint') }}</p>
          </div>
        }
      </div>
    </section>
  </div>

  <!-- Absolute Seal Layer -->
  <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 pointer-events-none">
    <div class="pointer-events-auto">
      <!-- The Seal Component -->
      <div class="relative">
        <!-- Seal visual container -->
        <div class="relative w-48 h-48 flex items-center justify-center">
          <!-- Outer Ring: slow spin -->
          <div class="absolute inset-0 border-2 border-dashed border-gray-400 dark:border-gray-500 rounded-full animate-spin [animation-duration:30s] [animation-timing-function:linear]"></div>
          <!-- Middle Ring: reverse spin -->
          <div class="absolute inset-3 border-2 border-solid border-gray-400/50 dark:border-gray-500/50 rounded-full animate-spin-reverse [animation-duration:20s] [animation-timing-function:linear]"></div>
          <!-- Central Clickable Area -->
          <button 
              (click)="toggleDevelopmentInfo()" 
              aria-label="Show development status information"
              class="relative flex flex-col items-center justify-center w-36 h-36 rounded-full bg-white/50 dark:bg-gray-800/50 hover:bg-white/70 dark:hover:bg-gray-800/70 backdrop-blur-sm group transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#8A6B93] focus:ring-offset-[#F5F3EF] dark:focus:ring-offset-[#1C1A27]">
              <svg class="w-12 h-12 text-gray-500 dark:text-gray-400 mb-1 group-hover:text-[#8A6B93] dark:group-hover:text-purple-400 transition-colors duration-300" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.472-2.472a3.375 3.375 0 000-4.773L12.293 6.293a3.375 3.375 0 00-4.773 0L6.293 7.511a3.375 3.375 0 000 4.774l2.472 2.472M11.42 15.17l-2.472 2.472a3.375 3.375 0 01-4.773 0L2.25 15.722a3.375 3.375 0 010-4.774l2.472-2.472" />
              </svg>
              <span class="font-bold text-sm text-[#292639] dark:text-white">{{ t('pages.status.inDevelopmentTitle') }}</span>
              <span class="text-xs text-gray-500 dark:text-gray-400">Details</span>
          </button>
        </div>
          
        @if (showDevelopmentInfo()) {
            <div 
                role="tooltip"
                class="absolute bottom-full mb-4 w-72 p-4 bg-white dark:bg-[#292639] rounded-lg shadow-2xl border border-gray-200 dark:border-gray-700 text-left animate-slide-up-fade-in left-1/2 -translate-x-1/2">
                <h4 class="font-bold text-[#292639] dark:text-white">{{ t('pages.status.inDevelopmentTitle') }}</h4>
                <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                    {{ t('pages.status.inDevelopmentMessage') }}
                </p>
                <button (click)="toggleDevelopmentInfo()" aria-label="Close information tooltip" class="absolute top-2 right-2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
        }
      </div>
    </div>
  </div>
</div>