<section class="py-16 sm:py-24 bg-charcoal">
  <div class="max-w-7xl mx-auto px-6 sm:px-8 lg:px-12">
    <!-- Use a grid for two columns on medium screens and up -->
    <div class="grid md:grid-cols-2 md:gap-16 lg:gap-24 items-start">
      
      <!-- Wrapper for Sticky Column -->
      <div class="h-[70vh] md:h-auto">
        <!-- Left Sticky Column -->
        <div class="md:sticky top-28 h-full" appAnimateOnScroll>
          <div class="relative w-full h-full flex flex-col justify-between rounded-2xl overflow-hidden">
            <!-- Image Backgrounds -->
            <div class="absolute inset-0">
              <!-- Default state -->
              <div class="absolute inset-0 bg-charcoal-light transition-opacity duration-700 ease-in-out" 
                   [class.opacity-100]="!imageForService()"
                   [class.opacity-0]="imageForService()">
                <div class="absolute inset-0 bg-[linear-gradient(45deg,rgba(255,255,255,0.02)_25%,transparent_25%,transparent_50%,rgba(255,255,255,0.02)_50%,rgba(255,255,255,0.02)_75%,transparent_75%,transparent)] bg-[length:60px_60px] opacity-50"></div>
              </div>
  
              <!-- Service-specific images -->
              @for (service of services; track service.name) {
                <div 
                  class="absolute inset-0 bg-cover bg-center transition-opacity duration-700 ease-in-out filter grayscale"
                  [style.background-image]="'url(' + service.imageUrl + ')'"
                  [class.opacity-100]="imageForService() === service.name"
                  [class.opacity-0]="imageForService() !== service.name">
                </div>
              }
              <!-- Gradient Overlay for Text Readability -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent"></div>
            </div>

            <!-- Text Content -->
            <div class="relative p-8 flex flex-col h-full">
              <div class="flex-grow">
                  <h2 class="text-4xl sm:text-5xl font-bold tracking-tight text-white" appShimmerText [alternateText]="'Soluções Digitais Sob Medida'">Minhas Disciplinas Fundamentais</h2>
                  <p class="mt-6 text-lg text-gray-300">
                    Cada disciplina é uma faceta de um todo coeso, integrada para gerar um impacto fundamental. Fundo princípios estratégicos com design de precisão e engenharia robusta para construir os alicerces digitais do futuro.
                  </p>
              </div>
              <div class="mt-8 flex-shrink-0">
                <button 
                  type="button" 
                  (click)="scrollToQuoteBuilder()" 
                  class="bg-white text-black rounded-full px-8 py-4 text-lg font-semibold btn-fancy">
                  <span class="btn-content inline-flex items-center gap-3">
                    <span>Explorar Engenharia</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Right Scrollable Column -->
      <div class="mt-12 md:mt-0">
        <div class="space-y-6">
          @for (service of services; track service.name; let i = $index) {
            <div
              (click)="toggleService(service.name)"
              (mouseenter)="onServiceMouseEnter(service.name)"
              (mouseleave)="onServiceMouseLeave()"
              appAnimateOnScroll
              [animationDelay]="(i * 100) + 200 + 'ms'"
              class="group relative border border-white/10 rounded-2xl backdrop-blur-sm transition-all duration-300 ease-in-out cursor-pointer overflow-hidden"
              [class.hover:-translate-y-1]="selectedService() !== service.name"
              [style.--theme-color]="service.themeColor">
              
              <div class="absolute inset-0 rounded-2xl border-2 border-transparent group-hover:border-[var(--theme-color)] transition-all duration-300 pointer-events-none"
                   [class.border-[var(--theme-color)]]="selectedService() === service.name" aria-hidden="true"></div>
              
              <div class="relative z-10 p-8">
                <div class="flex items-start gap-6">
                  <div class="text-gray-400 group-hover:text-[var(--theme-color)] transition-colors duration-300 mt-1 flex-shrink-0"
                       [class.text-[var(--theme-color)]]="selectedService() === service.name">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10" [innerHTML]="service.iconSvg"></svg>
                  </div>
                  <div class="flex-grow">
                    <h3 class="text-2xl font-semibold text-gray-100 group-hover:text-white transition-colors duration-300"
                        [class.text-white]="selectedService() === service.name">{{ service.name }}</h3>
                    <p class="text-gray-400 group-hover:text-gray-300 mt-2 transition-colors duration-300"
                       [class.text-gray-300]="selectedService() === service.name">{{ service.description }}</p>
                  </div>
                   <div class="text-white flex-shrink-0 ml-auto pl-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform duration-500 ease-in-out" 
                         [class.rotate-180]="selectedService() === service.name"
                         fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                  </div>
                </div>
              </div>

              <!-- Collapsible details -->
              <div class="overflow-hidden transition-[max-height] duration-700 ease-in-out"
                  [class.max-h-0]="selectedService() !== service.name"
                  [class.max-h-[1000px]]="selectedService() === service.name">
                <div class="px-8 pb-8 pt-6 border-t border-white/10">
                  <p class="text-gray-300 mb-6">{{ service.details }}</p>
                  <div class="grid sm:grid-cols-2 gap-8">
                    <div>
                      <h4 class="text-lg font-semibold text-white mb-4">Benefícios Fundamentais</h4>
                      <ul class="space-y-2 text-gray-300">
                        @for(benefit of service.benefits; track benefit) {
                          <li class="flex items-start gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-green-400 mt-1 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                            <span>{{ benefit }}</span>
                          </li>
                        }
                      </ul>
                    </div>
                    <div>
                      <h4 class="text-lg font-semibold text-white mb-4">Pilha Tecnológica</h4>
                      <div class="flex flex-wrap gap-2">
                          @for(tech of service.techStack; track tech) {
                              <span class="bg-charcoal text-gray-300 text-sm font-medium px-3 py-1 rounded-full border border-gray-700">{{ tech }}</span>
                          }
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

    </div>
  </div>
</section>